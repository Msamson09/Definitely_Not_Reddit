<%- include('../partials/html-head') %>
<%- include('../partials/nav') %>

<main class="container">
    <h1>Hello, <%= user ? user.profile.name : "friend" %></h1>
        <% if (user?.profile.avatar) { %>
        
        <% } %>
    <h1 class="my-3"><%= title %></h1>
    <%# This is where our message creation form will go %> 
    <form action="/posts" method="POST">
        <h2>
        Write a Post
        </h2>
        <div id="post" class="mb-3 mx-5">
            <label for="title-input" class="form-label">Title</label>
            <input 
                type="text" 
                class="form-control" 
                id="title-input" 
                placeholder="Your title"
                name="title"
            >
        </div>
        <div id="post" class="col-10 mb-3 mx-5">
            <label for="post-content" class="form-label">Post</label>
            <textarea name="text" class="form-control form-control-lg" id="post-content" rows="5"></textarea>
        </div>
        <button id="post" class="btn btn-primary ms-5" type="submit">Create Post</button>
    </form>
    <% posts.forEach(post => { %>
        <a href="/posts/<%= post._id %>" id=post-title><h2><%= post.title %></h2></a>
        <h2><%= post.text %> </h2>
        <h2>Posted by: <%= post.author.name %> </h2>
        <% if (user.profile._id.equals(post.author._id)) { %>
            <form action="/posts/<%= post._id %>?_method=DELETE" method="POST">
                <button type="submit">Delete</button>
            </form>
            <a href="/posts/<%= post._id %>/edit">Update</a>
        <% } %>
     
    <% }) %>
   
</main>
<%- include('../partials/footer') %>